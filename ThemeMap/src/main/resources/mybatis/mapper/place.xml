<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.ssafy.theme.place.mapper.PlaceMapper">

	<resultMap type="placeDto" id="place">
		<result column="place_id" property="placeId"/>
		<result column="place_name" property="placeName"/>
		<result column="latitude" property="latitude"/>
		<result column="longitude" property="longitude"/>
		<result column="score_sum" property="scoreSum"/>
		<result column="score_count" property="scoreCount"/>
		<result column="address" property="address"/>
		<result column="phone" property="phone"/>
	</resultMap>
	
	<insert id="createPlace" parameterType="placeDto">
		insert into place (place_id, place_name, latitude, longitude, address, phone)
		values (#{placeId}, #{placeName}, #{latitude}, #{longitude}, #{address}, #{phone})
	</insert>
	
	<select id="hotPlace" resultMap="place">
		select place_id, place_name, latitude, longitude, score_sum, score_count, address, phone from place
		where score_count != 0
		order by (score_sum / score_count) limit 10
	</select>
	
	<select id="placesOfTheme" parameterType="string" resultMap="place">
		select place_id, place_name, latitude, longitude, score_sum, score_count, address, phone from place
		where place_id = (
			select place_id from place_in_theme
			where theme_id = #{themeId}
		)
	</select>

</mapper>